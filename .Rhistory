setwd(paste0(Sys.getenv("CS_HOME"),"/UrbanDynamics/Models"))
Sys.getenv("CS_HOME")
Sys.setenv("CS_HOME","/home/JRaimbault/ComplexSystems")
help(Sys.setenv)
Sys.setenv(CS_HOME="/home/JRaimbault/ComplexSystems/")
setwd(paste0(Sys.getenv("CS_HOME"),"/UrbanDynamics/Models"))
setwd(paste0(Sys.getenv("CS_HOME"),"/UrbanDynamics/Models/ABMJobs-model"))
setwd(paste0(Sys.getenv("CS_HOME"),"/UrbanDynamics/Models/ABMJobMarket-model"))
install.packages("readstata13")
datadir = paste0(Sys.getenv("CS_HOME"),"Misc/BiblioDocs/UrbanDynamics/ABMJobs/STATA_20220128/DATA/Cleaning/")
workers <- read.dta13(paste0(datadir,"Leverhulme_worker_clean.dta"))
library(readstata13)
workers <- read.dta13(paste0(datadir,"Leverhulme_worker_clean.dta"))
summary(workers)
workers$permit
summary(workers$permit)
is.factor(workers$permit)
workers$works
workers$diversity
columns = c("works","income","hours_worked","time_job""social_security_cat","insurance","contract","nation_HH","permit")
columns = c("works","income","hours_worked","time_job","social_security_cat","insurance","contract","nation_HH","permit")
workers[,columns]
write.csv(workers[,columns],col.names = T, file = paste0(datadir,"worker_DCE.csv"))
write.csv(workers[,columns], file = paste0(datadir,"worker_DCE.csv"))
employers <- read.dta13(paste0(datadir,"Leverhulme_employer_clean.dta"))
names(employers)
dim(employers)
library(reshape2)
install.packages("reshape2")
library(reshape2)
dcetasks <- read.dta13(paste0(datadir,"dce_tasks.dta"))
names(dcetasks)
help(reshape)
names(employers)
aste0("task",1:18)
paste0("task",1:18)
reshape(employers, direction="long", varying=paste0("task",1:18))
reshape(employers, direction="long", varying=paste0("task",1:18),v.names=c("task"))
dim(employers)
employer_choices = reshape(employers, direction="long", varying=paste0("task",1:18),v.names=c("task"))
dim(employer_choices)
dim(employers)
610*17
610*18
names(employer_choices)
employer_choices$task
summary(employer_choices$task)
table(employer_choices$task)
names(employers)
employer_choices = reshape(employers, direction="long", varying=paste0("task",1:18),v.names=c("task"), times=1:18)
dim(employer_choices)
table(employer_choices$task)
names(employer_choices)
employer_choices = reshape(employers, direction="long", varying=paste0("task",1:18), times=1:18)
employer_choices$time
dim(employers)
employer_choices$id
employer_choices = reshape(employers, direction="long", varying=paste0("task",1:18),v.names=c("choice"), times=1:18, timevar="task")
table(employer_choices$choice)
table(employer_choices$task)
names(dcetasks)
employer_choices$task
dcetasks$task
left_merge
library(dplyr)
install.packages(dplyr)
install.packages("dplyr")
library(dplyr)
choices = left_merge(employer_choices,dcetasks, by = c("task"="task"))
choices = left_join(employer_choices,dcetasks, by = c("task"="task"))
dim(choices)
dim(employer_choices)
2*10980
dcetasks$task
dcetasks
table(dcetasks)
summary(dcetas  )
summary(dcetasks)
dim(choices)
jobs = choices %>%
group_by(dce_salary, dce_diversity, dce_hours, dce_skills,
dce_social_security, dce_insurance, dce_contract) %>%
summarise(choice=mean(choice))
warnings()
summary(choices$choice)
table(choices$choice)
choices$choice = as.numeric(choices$choice)
jobs = choices %>%
group_by(dce_salary, dce_diversity, dce_hours, dce_skills,
dce_social_security, dce_insurance, dce_contract) %>%
summarise(choice=mean(choice))
dim(jobs)
write.csv(jobs,file=paste0(datadir, "jobs.csv"))
write.csv(jobs,file=paste0(datadir, "jobs.csv"),row.names = F)
write.csv(jobs,file=paste0(datadir, "jobs.csv"),row.names = F, quote = F)
